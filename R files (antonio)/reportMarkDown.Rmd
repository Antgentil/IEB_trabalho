---
title: "**INSTITUTO SUPERIOR DE ENGENHARIA DE LISBOA**"
subtitle: |
  \large \textbf{Departamento de Matemática}  
  \large \textbf{Relatório para a Unidade Curricular de Introdução à Estatística Bayesiana dos cursos de LMATE e LEIC}
  
  \vspace{1cm}

  \LARGE \textbf{População e Emprego}
author: |
  Docente - Paula Cristina Pires Simões 
  \vspace{0.5cm}  
  -  Marta Pires Nº51726 
  - Daiana Lapaiescu Nº48668
  - Eduardo Tavares Nº 49454  
  - António Pimentel Nº42146  

date: "2024-12-12"
output:
  pdf_document:
    latex_engine: xelatex
header-includes:
  - \setcounter{page}{0}
---

\newpage

```{r include=FALSE}
#Biblioteca
library(dplyr)
library(stringr)
library(tidyverse)
library(lubridate)
library(zoo)
library(janitor)
library(brms)
library(bayesplot)
library(loo)
library(posterior)
library(broom)
library(bayesrules)
library(rstan)
library(rstanarm)
library(tidybayes)
library(janitor)
library(broom.mixed)
```


### Introdução

O desemprego constitui um dos indicadores mais importantes da situação económica e social de um país, refletindo de forma direta o dinamismo do mercado de trabalho, a capacidade produtiva da economia e o bem-estar das famílias. Em Portugal, entre 2011 e 2024, este indicador apresentou variações significativas associadas à crise económica e financeira, ao período de recuperação que se seguiu e ao impacto da pandemia de COVID-19. Estas oscilações tornam o estudo do desemprego particularmente relevante e atual.

A escolha deste tema resulta precisamente da sua importância para compreender como fatores económicos e demográficos influenciam a evolução do mercado de trabalho. Variáveis como o PIB real, a estrutura etária da população ativa, a remuneração média e o peso do setor terciário desempenham papéis centrais na explicação das dinâmicas laborais e ajudam a contextualizar períodos de maior estabilidade ou vulnerabilidade económica.

Assim, este trabalho tem como objetivo analisar a evolução da taxa de desemprego em Portugal ao longo dos últimos anos e avaliar de que forma estes fatores contribuem para a sua variação. O estudo insere-se no âmbito da Unidade Curricular de Introdução à Estatística Bayesiana, aplicando os métodos aprendidos à investigação de um fenómeno real com impacto económico e social significativo.

#nao sei se por
O relatório encontra-se estruturado em várias secções, incluindo o enquadramento teórico, a descrição e análise exploratória dos dados, a construção e estimação do modelo de regressão bayesiano, a apresentação e discussão dos resultados e, por fim, as principais conclusões do estudo

\newpage

### Leitura de Dados

Para começar, os dados são importados:
```{r results='hide'}
# Leitura dos Dados
library(readxl)
dados <- read_excel("Base_Dados_Final.xlsx")

#Inverter a Ordem dos dados do menor para o maior
dados <- dados %>%
  arrange(desc(row_number())) %>%  # inverte a ordem das linhas
  mutate(Trimestre = row_number())  # cria índice sequencial do mais antigo para o mais recente

# Visualizar primeiras linhas
head(dados)
```

```{r results='hide'}
# Verificar se existem valores omissos
na.fail(dados) #se correr é porque não há valores omissos
```

## Descrição dos Dados

### Variável dependente - Taxa de desemprego 
A variável dependente utilizada neste estudo é a **taxa de desemprego** em Portugal, medida trimestralmente pelo INE. A escolha desta variável justifica-se por ser um dos indicadores centrais do desempenho do mercado de trabalho e um reflexo direto das condições económicas e sociais do país.

A taxa de desemprego responde rapidamente a alterações na atividade económica, à evolução dos diferentes setores produtivos, às características da população ativa e aos choques económicos, como recessões ou crises sanitárias. Por estas razões, constitui uma medida adequada para analisar de que forma os principais fatores macroeconómicos e demográficos influenciam a procura de trabalho em Portugal.

### Variáveis independentes:
A seleção das variáveis independentes teve como objetivo incluir fatores que captam tanto a conjuntura económica do país como características estruturais do mercado de trabalho. Cada variável foi escolhida por representar um determinante plausível e frequentemente referido na literatura económica como influenciador do desemprego.

- **PIB real (em milhões de euros, por trimestre):** O Produto Interno Bruto real é um indicador fundamental da atividade económica. Períodos de crescimento do PIB tendem a estar associados à criação de emprego, enquanto fases de contração económica aumentam o risco de desemprego. Assim, o PIB real foi incluído para captar o efeito da conjuntura macroeconómica sobre o mercado de trabalho ao longo do tempo.
- **Remuneração média mensal bruta:** A remuneração média reflete simultaneamente o rendimento dos trabalhadores e os custos laborais enfrentados pelas empresas. Salários mais elevados podem indicar um mercado de trabalho mais dinâmico e competitivo, mas também podem representar maiores custos de contratação. A inclusão desta variável permite captar a forma como estas dinâmicas influenciam o nível de emprego e, consequentemente, o desemprego.
- **Percentagem de emprego no setor terciário:** O setor terciário representa a maior parte da estrutura económica portuguesa, abrangendo atividades como comércio, turismo e serviços. Alterações no peso relativo deste setor podem influenciar o desemprego devido à sua maior sensibilidade a flutuações económicas e choques externos. Esta variável permite captar possíveis mudanças estruturais na distribuição do emprego entre setores e o seu impacto no mercado de trabalho.
- **Proporção de jovens na população ativa:** A presença de trabalhadores mais jovens na força de trabalho é relevante para a dinâmica do desemprego, uma vez que este grupo apresenta maior rotatividade, maior taxa de entrada no mercado de trabalho e maior vulnerabilidade a ciclos económicos. Assim, a proporção de jovens (15–24 anos) na população ativa foi incluída para medir o impacto da composição etária da força laboral sobre a evolução do desemprego.


## Análise Exploratória dos Dados
Antes da construção do modelo estatístico, é essencial realizar uma análise exploratória dos dados, para compreender o comportamento das variáveis ao longo do tempo, identificar padrões e tendências, e avaliar a consistência das séries, detetando valores atípicos ou comportamentos inesperados.

Nesta secção, a análise exploratória foca-se na evolução temporal da taxa de desemprego e das variáveis explicativas selecionadas, examinando tendências gerais, picos ou quebras associados a instabilidades económicas, bem como relações simples entre variáveis, através de correlações e gráficos, fornecendo uma primeira visão das associações que serão estudadas formalmente no modelo bayesiano.

```{r results='hide'}
summary(dados %>% select(-Período, -Trimestre))
```


### Séries temporais de Cada Variável

```{r results='hide'}
## Gráficos de linha ao longo do tempo (Série Temporal)
library(ggplot2)
```

#### Evolução Temporal das Variáveis Independentes
Estas séries permitem observar como cada indicador evoluiu ao longo do período analisado e ajudam a compreender o seu possível impacto na taxa de desemprego.

##### **Variável "PIB_real":**

```{r fig1, echo=FALSE, fig.cap="Série Temporal do PIB Real"}}
# PIB Real ao longo do tempo
ggplot(dados, aes(x = Trimestre, y = PIB_real)) +
  geom_line(color = "lightpink", size = 1) +
  geom_point(color = "lightyellow") +
  labs(title = "Evolução do PIB Real", x = "Trimestre", y = "PIB Real") +
  theme_minimal()
```

O PIB real apresenta três fases bem definidas:
- Declínio inicial (trimestres 1–8), coincidente com a crise económica e o período de austeridade.
- Recuperação gradual e sustentada até 2019, com crescimento contínuo.
- Queda abrupta em 2020, resultante do impacto da pandemia COVID-19, seguida de uma forte recuperação nos trimestres posteriores.
Esta série mostra claramente a sensibilidade da economia portuguesa aos ciclos económicos e aos choques externos.


##### **Variável "Proporção_15_24":**

```{r fig2, echo=FALSE, fig.cap="Série Temporal da Proporção da População entre 15-24 Anos"}}
# Proporção da população 15-24 anos
ggplot(dados, aes(x = Trimestre, y = Proporção_15_24)) +
  geom_line(color = "lightgreen", size = 1) +
  geom_point(color = "darkgreen") +
  labs(title = "Proporção da população 15-24 anos", x = "Trimestre", y = "Proporção") +
  theme_minimal()
```

A proporção de jovens na força de trabalho apresenta uma tendência maioritariamente decrescente:
- Os valores iniciais situam-se perto dos 9%.
- Ao longo do período, observa-se uma redução progressiva até níveis próximos de 6%.
Este padrão é consistente com fenómenos demográficos como o envelhecimento populacional, menor natalidade e migração jovem para o exterior. A ligeira recuperação final sugere um aumento recente da participação jovem no mercado de trabalho.

###### **Variável "Emprego_Terciario":**

```{r fig3, echo=FALSE, fig.cap="Série Temporal do Emprego no Setor Terciário"}}
# Emprego no setor terciário
ggplot(dados, aes(x = Trimestre, y = Emprego_Terciario)) +
  geom_line(color = "lightblue", size = 1) +
  geom_point(color = "turquoise") +
  labs(title = "Emprego no setor terciário (%)", x = "Trimestre", y = "Emprego Terciário") +
  theme_minimal()
```

A proporção de trabalhadores no setor terciário mostra uma tendência claramente crescente ao longo dos trimestres.
- No início do período, situava-se ligeiramente acima de 67%.
- À medida que a economia portuguesa se foi tornando mais terciarizada, este valor aumentou de forma quase contínua até ultrapassar os 72%.

Este comportamento reflete a crescente importância dos serviços — como turismo, comércio e atividades especializadas — na estrutura produtiva portuguesa.

##### **Variável "Rendimento_medio_liquido":**

```{r fig4, echo=FALSE, fig.cap="Série Temporal do Rendimento Médio Líquido"}}
# Rendimento médio líquido
ggplot(dados, aes(x = Trimestre, y = Rendimento_medio_liquido)) +
  geom_line(color = "violet", size = 1) +
  geom_point(color ="purple") +
  labs(title = "Rendimento Médio Líquido", x = "Trimestre", y = "Rendimento") +
  theme_minimal()
```

A remuneração média líquida evidencia uma tendência crescente bastante marcada:
- No início do período, os valores situavam-se abaixo dos 850 €.
- A partir de meados da série, o crescimento torna-se mais acentuado, ultrapassando os 1100 € nos últimos trimestres.
Este aumento pode refletir fatores como melhoria salarial gradual, políticas de valorização do rendimento do trabalho e evolução positiva do mercado laboral.


#### Evolução da Variável Dependente: Taxa de Desemprego

```{r fig5, echo=FALSE, fig.cap="Série Temporal da Taxa de Desemprego"}}
# Taxa de desemprego
ggplot(dados, aes(x = Trimestre, y = Taxa_Desemprego)) +
  geom_line(color = "pink", size = 1) +
  geom_point(color = "darkred") +
  labs(title = "Taxa de Desemprego (%)", x = "Trimestre", y = "Taxa de Desemprego") +
  theme_minimal()

```
O gráfico da taxa de desemprego mostra uma trajetória muito clara, composta por três momentos principais:

##### 1. Subida significativa (2011–2013):
- A taxa de desemprego sobe rapidamente de cerca de 12% para valores superiores a 17%–18%.
- Este pico coincide com a crise económica, o período de resgate financeiro e a forte contração do mercado de trabalho.

##### 2. Queda contínua e expressiva (2014–2019):
- Por volta do trimestre 12 (4º trimestre de 2013), observa-se uma descida quase ininterrupta.
- O desemprego recua para valores abaixo de 7%.
Este período acompanha a recuperação económica, o aumento do investimento e a melhoria das condições do mercado laboral.

##### 3. Choque da pandemia e estabilização (2020–2024)
- Verifica-se um pequeno aumento em 2020, mas muito inferior ao observado em 2011–2013.
- Após essa oscilação, a taxa estabiliza entre 6% e 8%, com pequenas variações individuais por trimestre.

Este comportamento destaca a resiliência do mercado de trabalho português no pós-pandemia, apoiado por políticas de manutenção do emprego.


### Correlação

A matriz de correlação permite observar a direção e a intensidade das relações lineares entre a taxa de desemprego e cada uma das variáveis explicativas. Embora a correlação não estabeleça causalidade, fornece uma primeira indicação sobre quais variáveis podem ter maior influência na evolução do desemprego e sobre a coerência das relações observadas nos gráficos temporais.

```{r fig6, echo=FALSE, fig.cap="Gráfico de Correlação"}}

# Correlação simples
cor(dados %>% select(-Período, -Trimestre))

#Gráfico de Correlação
library(corrplot)
corrplot(cor(dados %>% select(-Período, -Trimestre)), method = "circle", type = "upper")

```
#### Taxa de desemprego e PIB real — correlação negativa
A correlação entre o PIB real e a taxa de desemprego é negativa, refletindo que:
- Quando o PIB aumenta, o desemprego tende a diminuir.
- Esta relação é consistente com a teoria económica: maior atividade económica promove criação de emprego.

#### Taxa de desemprego e rendimento médio — correlação negativa
O rendimento médio apresenta uma correlação negativa com o desemprego, indicando que:
- Em períodos de menor desemprego, o rendimento do trabalho tende a crescer.
- Isto reflete a melhoria do mercado laboral e maior competitividade salarial.
A relação, embora lógica, pode não ser muito forte devido à evolução gradual dos salários ao longo do período.

#### Taxa de desemprego e percentagem de emprego no setor terciário — correlação tendencialmente negativa
A proporção de emprego no setor terciário tende a aumentar ao longo do período, enquanto o desemprego diminui, o que resulta numa correlação negativa:
- Economias mais terciarizadas e orientadas para serviços tendem a absorver mais mão-de-obra.
- O setor dos serviços, particularmente turismo e comércio, tem forte influência no emprego em Portugal.

#### Taxa de desemprego e proporção de jovens na população ativa — correlação positiva
A proporção de jovens apresenta uma correlação positiva com o desemprego:
- Populações mais jovens têm maior rotatividade laboral e maior taxa de entrada no mercado de trabalho.
- Os jovens são historicamente mais vulneráveis a choques económicos e apresentam taxas de desemprego superiores ao total da população ativa.
Esta relação confirma que mudanças demográficas podem influenciar significativamente a dinâmica do desemprego.


## Especificação do Modelo Bayesiano


- **Modelo base (regressão linear múltipla):**
Tendo em conta o objetivo de estudar de que forma diferentes fatores socioeconómicos influenciam a taxa de desemprego em Portugal, recorreu-se a um modelo de regressão linear múltipla em enquadramento bayesiano, que serve para diagnostico preliminar.. Este tipo de modelo permite quantificar o efeito médio de cada variável explicativa na variável dependente enquanto incorpora, de forma explícita, a incerteza associada às estimativas dos parâmetros.

No nosso caso, especificou-se o seguinte modelo:

$$
Taxa\_Desemprego_t = \beta_0 + \beta_1(PIB\_Real_t) + \beta_2(Proporção\_15\_24_t) + \beta_3(Emprego\_Terciário_t) + \beta_4(Rendimento\_Médio\_Líquido_t) + \varepsilon_t
$$
onde,
- $\beta_0$ representa o intercepto,
- $\beta_i$representam os efeitos das variáveis explicativas,
- $ \varepsilon_t \sim N(0,\sigma))$ representa o erro aleatório.

Uma etapa crucial consiste em determinar a distribuição adequada para modelar esta variável. Apesar de a taxa de desemprego ser uma proporção, observamos que os valores trimestrais apresentam comportamento contínuo e relativamente simétrico, sem se aproximarem de 0% ou 100%. Além disso, as variações entre trimestres são moderadas, a volatilidade é baixa e não se observam caudas pesadas ou assimetrias significativas. Essas características tornam a distribuição Normal uma escolha apropriada, pois ela descreve de forma adequada variáveis contínuas, simétricas e com dispersão moderada.

Portanto, assumimos que:

$$

Y_t| \mu,\sigma \sim N(\mu,\sigma^2)

$$
,onde $\mu $representa a média da taxa de desemprego e $\sigma^2 $ a sua variância. Esta suposição permite-nos aplicar modelos de regressão clássicos e realizar inferência estatística de forma consistente e interpretável.

Pelo código, fazemos o modelo de regressão linear múltipla bayesiana:
```{r results='hide'}
# Modelo Múltiplo Bayesiano
library(lubridate)
modelo1 <- lm(Taxa_Desemprego ~ PIB_real + Proporção_15_24 +
                Emprego_Terciario + Rendimento_medio_liquido,
              data = dados)
summary(modelo1)

```



### Especificação das Prioris


```{r results='hide'}

```


```{r results='hide'}
#Distribuição Posteriori
data(dados)
ggplot(dados, aes(x = Trimestre, y = Taxa_Desemprego)) + 
  geom_point(size = 0.5) + 
  geom_smooth(method = "lm", se = FALSE)
```



Precisamos especificar modelos a priori para cada uma das variáveis. Para isso, utilizaremos a estrutura padrão de modelos a priori usada pelo pacote
 rstanarm. 

### Simulação posteriori
```{r results='hide'}

```



## Diagnóstico e Avaliação

### Simulação via rstanarm

```{r results='hide'}
# Definir um modelo com priors fracos (nao informativos)
modelo_bayes <- stan_glm(Taxa_Desemprego ~ PIB_real + Proporção_15_24 + Emprego_Terciario + Rendimento_medio_liquido, 
                         data = dados,
                         family = gaussian(),
                         prior = normal(0, 10),             # prior para os betas
                         prior_intercept = normal(0, 20),   # prior para intercepto
                         chains = 4,                        # numero de cadeias MCMC
                         iter = 4000,                       # nº total de iteracoes
                         warmup = 1000,                     # burn-in
                         seed = 123
)

```

## Avaliação modelo

Link abaixo indica valores ideais para Rhat e neff ratio, para utilizar em fontes
https://search.r-project.org/CRAN/refmans/bayesplot/html/MCMC-diagnostics.html

Utilizamos a medida Rhat para comparar as 4 cadeias simuladas por stan_glm.

```{r}
rhat(modelo_bayes)

mcmc_rhat(rhat(modelo_bayes))
```


Os valores obtidos encontram-se abaixo de 1.05, indicando semelhança forte nas cadeias.


Utiliza-se também o diagnóstico neff ratio para mcmc.

```{r}
neff_ratio(modelo_bayes)

mcmc_neff(neff_ratio(modelo_bayes)) 
```

Neste caso também vemos linhas azuis em todos os valores, indicando um bom rácio do tamanho de
amostras efetivas.

## Previsões

dados %>% 
  filter(date == "2012-10-22") %>% 
  select(Trimestre, dados)
  temp_feel rides



## Conclusão