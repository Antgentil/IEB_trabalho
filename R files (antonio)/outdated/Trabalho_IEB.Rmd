---
title: '**INSTITUTO SUPERIOR DE ENGENHARIA DE LISBOA**'
author: "Docente - Paula Cristina Pires Simões \n\\vspace{0.5cm}  \n-  Marta Pires
  Nº51726 \n- Daiana Lapaiescu Nº48668\n- Eduardo Tavares Nº 49454  \n- António Pimentel
  Nº42146  \n"
date: "2025-06-12"
output:
  pdf_document:
    latex_engine: xelatex
  html_document:
    df_print: paged
subtitle: "\\large \\textbf{Departamento de Matemática}  \n\\large \\textbf{Relatório
  para a Unidade Curricular de Introdução à Estatística Bayesiana dos cursos de LMATE
  e LEIC}\n\n\\vspace{1cm}\n\n\\LARGE \\textbf{População e Emprego}\n"
header-includes: \setcounter{page}{0}
---

\newpage

```{r, include=FALSE}
options(tinytex.verbose = TRUE)
```


```{r include=FALSE}
#Biblioteca
library(dplyr)
library(stringr)
library(tidyverse)
library(lubridate)
library(zoo)
library(janitor)
library(brms)
library(bayesplot)
library(loo)
library(posterior)
library(broom)
library(bayesrules)
library(rstan)
library(rstanarm)
library(tidybayes)
library(janitor)
library(broom.mixed)
```


### Introdução

O desemprego constitui um dos indicadores mais importantes da situação económica e social de um país, refletindo de forma direta o dinamismo do mercado de trabalho, a capacidade produtiva da economia e o bem-estar das famílias. Em Portugal, entre 2011 e 2024, este indicador apresentou variações significativas associadas à crise económica e financeira, ao período de recuperação que se seguiu e ao impacto da pandemia de COVID-19. Estas oscilações tornam o estudo do desemprego particularmente relevante e atual.

A escolha deste tema resulta precisamente da sua importância para compreender como fatores económicos e demográficos influenciam a evolução do mercado de trabalho. Variáveis como o PIB real, a estrutura etária da população ativa, a remuneração média e o peso do setor terciário desempenham papéis centrais na explicação das dinâmicas laborais e ajudam a contextualizar períodos de maior estabilidade ou vulnerabilidade económica.

Assim, este trabalho tem como objetivo analisar a evolução da taxa de desemprego em Portugal ao longo dos últimos anos e avaliar de que forma estes fatores contribuem para a sua variação. O estudo insere-se no âmbito da Unidade Curricular de Introdução à Estatística Bayesiana, aplicando os métodos aprendidos à investigação de um fenómeno real com impacto económico e social significativo.

\newpage

### Recolha e Organização de Dados:

O primeiro passo consiste em recolher dados oficiais sobre a taxa de desemprego e indicadores socioeconómicos em Portugal, provenientes do INE ou PORDATA. Foram considerados dados trimestrais de diferentes indicadores: PIB real, proporção da população jovem (15-24 anos), emprego no setor terciário e rendimento médio líquido.

Para começar, os dados são importados:
```{r results='hide'}
# Leitura dos Dados
library(readxl)
dados <- read_excel("Base_Dados_Final.xlsx")

#Inverter a Ordem dos dados do menor para o maior
dados <- dados %>%
  arrange(desc(row_number())) %>%  # inverte a ordem das linhas
  mutate(Trimestre = row_number())  # cria índice sequencial do mais antigo para o mais recente

# Visualizar primeiras linhas
head(dados)
```

```{r results='hide'}
# Verificar se existem valores omissos
na.fail(dados) #se correr é porque não há valores omissos
```

## Descrição dos Dados

### Variável dependente - Taxa de desemprego 
A variável dependente utilizada neste estudo é a **taxa de desemprego** em Portugal, medida trimestralmente pelo INE. A escolha desta variável justifica-se por ser um dos indicadores centrais do desempenho do mercado de trabalho e um reflexo direto das condições económicas e sociais do país.

A taxa de desemprego responde rapidamente a alterações na atividade económica, à evolução dos diferentes setores produtivos, às características da população ativa e aos choques económicos, como recessões ou crises sanitárias. Por estas razões, constitui uma medida adequada para analisar de que forma os principais fatores macroeconómicos e demográficos influenciam a procura de trabalho em Portugal.

### Variáveis independentes:
A seleção das variáveis independentes teve como objetivo incluir fatores que captam tanto a conjuntura económica do país como características estruturais do mercado de trabalho. Cada variável foi escolhida por representar um determinante plausível e frequentemente referido na literatura económica como influenciador do desemprego.

- **PIB real (em milhões de euros, por trimestre):** O Produto Interno Bruto real é um indicador fundamental da atividade económica. Períodos de crescimento do PIB tendem a estar associados à criação de emprego, enquanto fases de contração económica aumentam o risco de desemprego. Assim, o PIB real foi incluído para captar o efeito da conjuntura macroeconómica sobre o mercado de trabalho ao longo do tempo.
- **Remuneração média mensal bruta:** A remuneração média reflete simultaneamente o rendimento dos trabalhadores e os custos laborais enfrentados pelas empresas. Salários mais elevados podem indicar um mercado de trabalho mais dinâmico e competitivo, mas também podem representar maiores custos de contratação. A inclusão desta variável permite captar a forma como estas dinâmicas influenciam o nível de emprego e, consequentemente, o desemprego.
- **Percentagem de emprego no setor terciário:** O setor terciário representa a maior parte da estrutura económica portuguesa, abrangendo atividades como comércio, turismo e serviços. Alterações no peso relativo deste setor podem influenciar o desemprego devido à sua maior sensibilidade a flutuações económicas e choques externos. Esta variável permite captar possíveis mudanças estruturais na distribuição do emprego entre setores e o seu impacto no mercado de trabalho.
- **Proporção de jovens na população ativa:** A presença de trabalhadores mais jovens na força de trabalho é relevante para a dinâmica do desemprego, uma vez que este grupo apresenta maior rotatividade, maior taxa de entrada no mercado de trabalho e maior vulnerabilidade a ciclos económicos. Assim, a proporção de jovens (15–24 anos) na população ativa foi incluída para medir o impacto da composição etária da força laboral sobre a evolução do desemprego.


## Análise Exploratória dos Dados
Antes da construção do modelo estatístico, é essencial realizar uma análise exploratória dos dados, para compreender o comportamento das variáveis ao longo do tempo, identificar padrões e tendências, e avaliar a consistência das séries, detetando valores atípicos ou comportamentos inesperados.

Nesta secção, a análise exploratória foca-se na evolução temporal da taxa de desemprego e das variáveis explicativas selecionadas, examinando tendências gerais, picos ou quebras associados a instabilidades económicas, bem como relações simples entre variáveis, através de correlações e gráficos, fornecendo uma primeira visão das associações que serão estudadas formalmente no modelo bayesiano.

```{r}
library(fBasics)
basicStats(dados %>% select(-Período, -Trimestre))
```


### Séries temporais de Cada Variável

```{r results='hide'}
## Gráficos de linha ao longo do tempo (Série Temporal)
library(ggplot2)
```

#### Evolução Temporal das Variáveis Independentes
Estas séries permitem observar como cada indicador evoluiu ao longo do período analisado e ajudam a compreender o seu possível impacto na taxa de desemprego.

##### **Variável "PIB_real":**

```{r fig1, echo=FALSE, fig.cap="Série Temporal do PIB Real"}
# PIB Real ao longo do tempo
ggplot(dados, aes(x = Trimestre, y = PIB_real)) +
  geom_line(color = "lightpink", size = 1) +
  geom_point(color = "lightyellow") +
  labs(title = "Evolução do PIB Real", x = "Trimestre", y = "PIB Real") +
  theme_minimal()
```

O PIB real apresenta três fases bem definidas:
- Declínio inicial (trimestres 1–8), coincidente com a crise económica e o período de austeridade.
- Recuperação gradual e sustentada até 2019, com crescimento contínuo.
- Queda abrupta em 2020, resultante do impacto da pandemia COVID-19, seguida de uma forte recuperação nos trimestres posteriores.
Esta série mostra claramente a sensibilidade da economia portuguesa aos ciclos económicos e aos choques externos.


##### **Variável "Proporção_15_24":**

```{r fig2, echo=FALSE, fig.cap="Série Temporal da Proporção da População entre 15-24 Anos"}
# Proporção da população 15-24 anos
ggplot(dados, aes(x = Trimestre, y = Proporção_15_24)) +
  geom_line(color = "lightgreen", size = 1) +
  geom_point(color = "darkgreen") +
  labs(title = "Proporção da população 15-24 anos", x = "Trimestre", y = "Proporção") +
  theme_minimal()
```

A proporção de jovens na força de trabalho apresenta uma tendência maioritariamente decrescente:
- Os valores iniciais situam-se perto dos 9%.
- Ao longo do período, observa-se uma redução progressiva até níveis próximos de 6%.
Este padrão é consistente com fenómenos demográficos como o envelhecimento populacional, menor natalidade e migração jovem para o exterior. A ligeira recuperação final sugere um aumento recente da participação jovem no mercado de trabalho.

###### **Variável "Emprego_Terciario":**

```{r fig3, echo=FALSE, fig.cap="Série Temporal do Emprego no Setor Terciário"}
# Emprego no setor terciário
ggplot(dados, aes(x = Trimestre, y = Emprego_Terciario)) +
  geom_line(color = "lightblue", size = 1) +
  geom_point(color = "turquoise") +
  labs(title = "Emprego no setor terciário (%)", x = "Trimestre", y = "Emprego Terciário") +
  theme_minimal()
```

A proporção de trabalhadores no setor terciário mostra uma tendência claramente crescente ao longo dos trimestres.
- No início do período, situava-se ligeiramente acima de 67%.
- À medida que a economia portuguesa se foi tornando mais terciarizada, este valor aumentou de forma quase contínua até ultrapassar os 72%.

Este comportamento reflete a crescente importância dos serviços — como turismo, comércio e atividades especializadas — na estrutura produtiva portuguesa.

##### **Variável "Rendimento_medio_liquido":**

```{r fig4, echo=FALSE, fig.cap="Série Temporal do Rendimento Médio Líquido"}
# Rendimento médio líquido
ggplot(dados, aes(x = Trimestre, y = Rendimento_medio_liquido)) +
  geom_line(color = "violet", size = 1) +
  geom_point(color ="purple") +
  labs(title = "Rendimento Médio Líquido", x = "Trimestre", y = "Rendimento") +
  theme_minimal()
```

A remuneração média líquida evidencia uma tendência crescente bastante marcada:
- No início do período, os valores situavam-se abaixo dos 850 €.
- A partir de meados da série, o crescimento torna-se mais acentuado, ultrapassando os 1100 € nos últimos trimestres.
Este aumento pode refletir fatores como melhoria salarial gradual, políticas de valorização do rendimento do trabalho e evolução positiva do mercado laboral.


#### Evolução da Variável Dependente: Taxa de Desemprego

```{r fig5, echo=FALSE, fig.cap="Série Temporal da Taxa de Desemprego"}
# Taxa de desemprego
ggplot(dados, aes(x = Trimestre, y = Taxa_Desemprego)) +
  geom_line(color = "pink", size = 1) +
  geom_point(color = "darkred") +
  labs(title = "Taxa de Desemprego (%)", x = "Trimestre", y = "Taxa de Desemprego") +
  theme_minimal()

```

O gráfico da taxa de desemprego mostra uma trajetória muito clara, composta por três momentos principais:

##### 1. Subida significativa (2011–2013):
- A taxa de desemprego sobe rapidamente de cerca de 12% para valores superiores a 17%–18%.
- Este pico coincide com a crise económica, o período de resgate financeiro e a forte contração do mercado de trabalho.

##### 2. Queda contínua e expressiva (2014–2019):
- Por volta do trimestre 12 (4º trimestre de 2013), observa-se uma descida quase ininterrupta.
- O desemprego recua para valores abaixo de 7%.
Este período acompanha a recuperação económica, o aumento do investimento e a melhoria das condições do mercado laboral.

##### 3. Choque da pandemia e estabilização (2020–2024)
- Verifica-se um pequeno aumento em 2020, mas muito inferior ao observado em 2011–2013.
- Após essa oscilação, a taxa estabiliza entre 6% e 8%, com pequenas variações individuais por trimestre.

Este comportamento destaca a resiliência do mercado de trabalho português no pós-pandemia, apoiado por políticas de manutenção do emprego.


### Correlação

A matriz de correlação permite observar a direção e a intensidade das relações lineares entre a taxa de desemprego e cada uma das variáveis explicativas. Embora a correlação não estabeleça causalidade, fornece uma primeira indicação sobre quais variáveis podem ter maior influência na evolução do desemprego e sobre a coerência das relações observadas nos gráficos temporais.

```{r fig6, echo=FALSE, fig.cap="Gráfico de Correlação"}

# Correlação simples
cor(dados %>% select(-Período, -Trimestre))

#Gráfico de Correlação
library(corrplot)
corrplot(cor(dados %>% select(-Período, -Trimestre)), method = "circle", type = "upper")

```

#### Taxa de desemprego e PIB real — correlação negativa
A correlação entre o PIB real e a taxa de desemprego é negativa, refletindo que:
- Quando o PIB aumenta, o desemprego tende a diminuir.
- Esta relação é consistente com a teoria económica: maior atividade económica promove criação de emprego.

#### Taxa de desemprego e rendimento médio — correlação negativa
O rendimento médio apresenta uma correlação negativa com o desemprego, indicando que:
- Em períodos de menor desemprego, o rendimento do trabalho tende a crescer.
- Isto reflete a melhoria do mercado laboral e maior competitividade salarial.
A relação, embora lógica, pode não ser muito forte devido à evolução gradual dos salários ao longo do período.

#### Taxa de desemprego e percentagem de emprego no setor terciário — correlação tendencialmente negativa
A proporção de emprego no setor terciário tende a aumentar ao longo do período, enquanto o desemprego diminui, o que resulta numa correlação negativa:
- Economias mais terciarizadas e orientadas para serviços tendem a absorver mais mão-de-obra.
- O setor dos serviços, particularmente turismo e comércio, tem forte influência no emprego em Portugal.

#### Taxa de desemprego e proporção de jovens na população ativa — correlação positiva
A proporção de jovens apresenta uma correlação positiva com o desemprego:
- Populações mais jovens têm maior rotatividade laboral e maior taxa de entrada no mercado de trabalho.
- Os jovens são historicamente mais vulneráveis a choques económicos e apresentam taxas de desemprego superiores ao total da população ativa.
Esta relação confirma que mudanças demográficas podem influenciar significativamente a dinâmica do desemprego.


## Implementação do Modelo de Regressão Linear Múltipla Bayesiana

#### Especificação do Modelo Bayesiano
Tendo em conta o objetivo de estudar de que forma diferentes fatores socioeconómicos influenciam a taxa de desemprego em Portugal, recorreu-se a um modelo de regressão linear múltipla em enquadramento bayesiano, que serve para diagnostico preliminar. Este tipo de modelo permite quantificar o efeito médio de cada variável explicativa na variável dependente enquanto incorpora, de forma explícita, a incerteza associada às estimativas dos parâmetros.

No nosso caso, especificou-se o seguinte modelo:

$$
Taxa\_Desemprego_t = \beta_0 + \beta_1(PIB\_Real_t) + \beta_2(Proporção\_15\_24_t) + \beta_3(Emprego\_Terciário_t)\\ 
+ \beta_4(Rendimento\_Médio\_Líquido_t) + \varepsilon_t
$$

,onde

- $\beta_0$ representa o intercepto,
- $\beta_i$representam os efeitos das variáveis explicativas,
- $ \varepsilon_t \sim N(0,\sigma))$ representa o erro aleatório.

Uma etapa crucial consiste em determinar a distribuição adequada para modelar esta variável. Apesar de a taxa de desemprego ser uma proporção, observamos que os valores trimestrais apresentam comportamento contínuo e relativamente simétrico, sem se aproximarem de 0% ou 100%. Além disso, as variações entre trimestres são moderadas, a volatilidade é baixa e não se observam caudas pesadas ou assimetrias significativas. Essas características tornam a distribuição Normal uma escolha apropriada, pois ela descreve de forma adequada variáveis contínuas, simétricas e com dispersão moderada.

Portanto, assumimos que:

$$
Taxa\_Desemprego_t|\beta, \mu,\sigma \sim N(\mu,\sigma^2)
$$

,onde $\mu $representa a média da taxa de desemprego e $\sigma^2 $ a sua variância. Esta suposição permite-nos aplicar modelos de regressão clássicos e realizar inferência estatística de forma consistente e interpretável.

#### Especificação das Prioris

Optamos por prioris não informativos (ou fracamente informativos), que exercem pouca influência na distribuição a posteriori, permitindo que os dados dominem a inferência, ao mesmo tempo que evitam estimativas extremas, garantindo que o modelo aprenda essencialmente a partir dos dados.

- **Para os coeficientes da regressão:**  $\beta_i \sim N(0,1)$. Esta escolha traduz a crença de que os efeitos devem ser moderados, mas não impede que os dados revelem efeitos mais fortes.

- **Para o intercepto:** $\beta_0 \sim N(\mu_y{},3)$, centrado na média observada da taxa de desemprego, permitindo flexibilidade adequada.

- **Para a variabilidade dos erros:** $\sigma \sim Half-Student_t(3,0,2)$ Uma priori robusta, adequada quando se pretende evitar subestimação da variância residual.

Estas escolhas permitem um modelo estável, interpretável e coerente com a natureza das séries económicas utilizadas.

Precisamos especificar modelos a priori para cada uma das variáveis. Para isso, utilizaremos a estrutura padrão de modelos a priori usada pelo pacote rstanarm:

```{r results='hide'}
# Calcular a média antes
media_desemprego <- mean(dados$Taxa_Desemprego)

# Prioris
library(brms)
prioris <- c(
  set_prior("normal(0, 1)", class = "b"),
  set_prior(paste0("normal(", media_desemprego, ", 3)"), class = "Intercept"),
  set_prior("student_t(3, 0, 2)", class = "sigma")
)

```

#### Ajuste do Modelo
Após a especificação do modelo e a definição das prioris para os parâmetros, o próximo passo é realizar a inferência estatística, ou seja, ajustar o modelo através da amostragem MCMC. O código R utiliza a função <code>stan_glm</code> do pacote <code>rstanarm</code>, que usa o motor de inferência Stan para realizar esta amostragem.

```{r results='hide'}
# Ajustar o Modelo
library(rstanarm)
modelo_bayes <- stan_glm(
  Taxa_Desemprego ~ PIB_real + Proporção_15_24 + Emprego_Terciario + Rendimento_medio_liquido,
  data = dados,
  family = gaussian(),
  prior = normal(0,1),                             # priori para os betas
  prior_intercept = normal(media_desemprego,3 ),   # prioir para intercepto
  chains = 4,                                       
  iter = 4000,                       
  warmup = 1000,                     
  seed = 123
)
```

```{r}
summary(modelo_bayes)
```
```{r}
first_set <- head(modelo_bayes, 1)
first_set
```

## Diagnóstico de Convergência (R-hat e ESS)

A inferência Bayesiana MCMC requer um diagnóstico rigoroso para garantir que as cadeias simuladas convergiram para a verdadeira distribuição a posteriori. Dois indicadores principais são utilizados:

- **Fator de Escala Potencial ($\hat{R}$ ou Rhat):** O valor de $\hat{R}$ compara a variação dentro de cada cadeia com a variação entre todas as cadeias.

```{r fig7, echo=FALSE, fig.cap="Gráfico de R-hat"}
bayesplot::rhat(modelo_bayes)
mcmc_rhat(bayesplot::rhat(modelo_bayes))
```

Como todos os valores obtidos estão abaixo do limite de 1.05, consideramos que as 4 cadeias MCMC se misturaram bem e convergiram para uma mesma distribuição a posteriori.
 
- **Razão do Tamanho Efetivo da Amostra (Neff Ratio):** Este rácio avalia a eficiência da amostragem, medindo quantos sorteios independentes os sorteios MCMC equivalem. Uma razão próxima de 1 é ideal, e valores acima de 0.1 são aceitáveis.

```{r fig8, echo=FALSE, fig.cap="Gráfico de Neff Ratio"}
neff_ratio(modelo_bayes)
mcmc_neff(neff_ratio(modelo_bayes))
```

O nosso rácio eficaz de amostras (neff_ratio) é satisfatório para todos os parâmetros, indicando que obtivemos um número suficiente de amostras não correlacionadas para estimar as médias a posteriori de forma fiável.

## Posteriori
Após ajustar o modelo bayesiano, procedemos à estimação dos parâmetros via MCMC. Aqui apresentamos os resultados das distribuições a posteriori, permitindo não só obter os valores médios de cada variável explicativa (estimativas pontuais), mas também quantificar a incerteza associada a essas estimativas. 
```{r}
# Posterior summary statistics
library(broom.mixed)
tidy(modelo_bayes, effects = c("fixed", "aux"), conf.int = TRUE)
```

Esta análise conecta o modelo teórico previamente especificado com os valores observados nos dados, oferecendo uma interpretação quantitativa das relações económicas estudadas:

$$

(1.086091e+02) - (4.768032e-04)(PIB\_Real_t) + (4.005751e-02)(Proporção\_15\_24_t) + (-9.562027e-01)(Emprego\_Terciário_t)\\ 
- (5.296195e-03)(Rendimento\_Médio\_Líquido_t)
$$

A mediana posterior dos coeficientes sugere que o emprego no setor terciário exerce um efeito negativo consistente sobre a taxa de desemprego, ou seja, um aumento relativo no emprego terciário está associado a uma redução da taxa de desemprego. Por outro lado, o PIB real e o rendimento médio líquido apresentam coeficientes próximos de zero, indicando pouca influência direta trimestral sobre o desemprego. A proporção da população jovem (15-24 anos) apresenta um efeito positivo pequeno, sugerindo que aumentos nesta faixa etária podem contribuir para uma ligeira subida da taxa de desemprego.

Estas estatísticas permitem interpretar de forma mais robusta os efeitos médios de cada variável, considerando explicitamente a incerteza da estimativa, o que é uma das vantagens centrais da abordagem bayesiana.


## Previsões Posteriori
Com os parâmetros estimados pelo modelo bayesiano, é possível gerar previsões da taxa de desemprego para os períodos observados, incorporando a incerteza das estimativas. Utilizando as amostras MCMC, calculamos tanto as previsões pontuais (média das amostras) quanto os intervalos de credibilidade a 95%, que indicam a faixa de valores mais prováveis para cada trimestre.
```{r}
#Previsões pontuais (média das amostras MCMC)
previsoes <- posterior_predict(modelo_bayes, dados) 
prediction_mean <- apply(previsoes, 2, mean)

# Intervalos de credibilidade a 95%
posterior_interval(modelo_bayes, prob = 0.95)   
```

```{r fig9, echo=FALSE, fig.cap="Gráfico da Previsão de Bayes"}
# Gráfico comparativo: valores previstos vs observados
plot(prediction_mean, type = "b", col = "pink", pch = 20,
 xlab = "Trimester", ylab = "Percentagem %", main = "Comparação de Original vs previsão ")
 lines(dados$Taxa_Desemprego, type = "b", col = "violet", pch = 21)
 legend("topright", legend = c("Previsão Bayes", "Dados desemprego"),
 col = c("pink", "violet"), lty = 1, pch = c(20, 21))
```

O gráfico comparativo entre os valores previstos e os dados observados permite avaliar visualmente o ajuste do modelo. Observa-se que o modelo consegue reproduzir bem o padrão temporal da taxa de desemprego, embora pequenas discrepâncias possam surgir em períodos de maior volatilidade ou choques econômicos não capturados pelos regressores.

## Conclusão

escrever